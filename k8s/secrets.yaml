# =============================================================================
# Kubernetes Secrets - SDBIP/IDP Management System
# NOTE: In production, use External Secrets Operator or AWS Secrets Manager
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: sdbip-secrets
  namespace: sdbip
  labels:
    app: sdbip
type: Opaque
stringData:
  # Database (replace with actual values or use external secrets)
  DB_HOST: "sdbip-mysql.cluster-xxx.af-south-1.rds.amazonaws.com"
  DB_USERNAME: "sdbip_user"
  DB_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"

  # Redis (if authentication required)
  REDIS_PASSWORD: ""

  # Application
  APP_KEY: "base64:REPLACE_WITH_SECURE_KEY"

  # AWS (use IAM roles instead when possible)
  AWS_ACCESS_KEY_ID: "REPLACE_WITH_ACCESS_KEY"
  AWS_SECRET_ACCESS_KEY: "REPLACE_WITH_SECRET_KEY"

  # OpenAI API (optional, for AI reports)
  OPENAI_API_KEY: ""

  # LDAP (for Active Directory)
  LDAP_BIND_PASSWORD: "REPLACE_WITH_LDAP_PASSWORD"

  # Mail
  MAIL_USERNAME: "noreply@municipality.gov.za"
  MAIL_PASSWORD: "REPLACE_WITH_MAIL_PASSWORD"

---
# =============================================================================
# TLS Secret for Ingress
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: sdbip-tls-secret
  namespace: sdbip
  labels:
    app: sdbip
type: kubernetes.io/tls
data:
  # Base64 encoded certificate and key
  # Replace with actual certificate data
  tls.crt: LS0tLS1CRUdJTi... # Base64 encoded certificate
  tls.key: LS0tLS1CRUdJTi... # Base64 encoded private key

---
# =============================================================================
# Docker Registry Secret (for private images)
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: ghcr-secret
  namespace: sdbip
  labels:
    app: sdbip
type: kubernetes.io/dockerconfigjson
data:
  # Base64 encoded Docker config JSON
  .dockerconfigjson: eyJhdXRocyI6e... # Replace with actual registry credentials

---
# =============================================================================
# External Secrets Operator Example (for AWS Secrets Manager)
# =============================================================================
# Uncomment and configure if using External Secrets Operator
#
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   name: sdbip-external-secrets
#   namespace: sdbip
# spec:
#   refreshInterval: 1h
#   secretStoreRef:
#     kind: ClusterSecretStore
#     name: aws-secrets-manager
#   target:
#     name: sdbip-secrets
#     creationPolicy: Owner
#   data:
#     - secretKey: DB_PASSWORD
#       remoteRef:
#         key: sdbip/database
#         property: password
#     - secretKey: DB_USERNAME
#       remoteRef:
#         key: sdbip/database
#         property: username
#     - secretKey: OPENAI_API_KEY
#       remoteRef:
#         key: sdbip/api-keys
#         property: openai
